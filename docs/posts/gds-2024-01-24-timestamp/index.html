<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-01-24">

<title>Python datetimes manipulations – A Geospatial Data Science Blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VPPV7D4HSQ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-VPPV7D4HSQ', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Python datetimes manipulations – A Geospatial Data Science Blog">
<meta name="twitter:description" content="Code fragments for timestamps and timezones manipulation">
<meta name="twitter:image" content="https://sebastianof.github.io/GeoDsBlog/posts/gds-2024-01-24-timestamp/images/cover.png">
<meta name="twitter:image-height" content="928">
<meta name="twitter:image-width" content="1660">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">A Geospatial Data Science Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-posts" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Posts</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-posts">    
        <li>
    <a class="dropdown-item" href="../../posts/all.html">
 <span class="dropdown-text">All posts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../posts/gds.html">
 <span class="dropdown-text">Geospatial Data Science</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../posts/bp.html">
 <span class="dropdown-text">Code development</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-about">    
        <li>
    <a class="dropdown-item" href="../../about/about.html">
 <span class="dropdown-text">Author and feedback</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../about/CV_for_humans/curriculum.pdf">
 <span class="dropdown-text">CV for humans</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../about/CV_for_machines/curriculum.docx.pdf">
 <span class="dropdown-text">CV for machines</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sebastianof/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:sebastiano.ferraris@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Python datetimes manipulations</h1>
            <p class="subtitle lead">Code fragments for timestamps and timezones manipulation</p>
                                <div class="quarto-categories">
                <div class="quarto-category">tutorial</div>
                <div class="quarto-category">geospatial</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 24, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#datetime.datetime-to-str-and-back" id="toc-datetime.datetime-to-str-and-back" class="nav-link" data-scroll-target="#datetime.datetime-to-str-and-back"><code>datetime.datetime</code> to <code>str</code> and back</a></li>
  <li><a href="#datetime.datetime-to-int-and-back" id="toc-datetime.datetime-to-int-and-back" class="nav-link" data-scroll-target="#datetime.datetime-to-int-and-back"><code>datetime.datetime</code> to <code>int</code> and back</a></li>
  <li><a href="#datetime.datetime-str-and-int-to-pandas.timestamp-and-back" id="toc-datetime.datetime-str-and-int-to-pandas.timestamp-and-back" class="nav-link" data-scroll-target="#datetime.datetime-str-and-int-to-pandas.timestamp-and-back"><code>datetime.datetime</code>, <code>str</code> and <code>int</code> to <code>pandas.Timestamp</code> and back</a>
  <ul class="collapse">
  <li><a href="#pandas-timestamp-to-int" id="toc-pandas-timestamp-to-int" class="nav-link" data-scroll-target="#pandas-timestamp-to-int">Pandas <code>Timestamp</code> to <code>int</code></a></li>
  <li><a href="#pandas-timestamp-to-str" id="toc-pandas-timestamp-to-str" class="nav-link" data-scroll-target="#pandas-timestamp-to-str">Pandas <code>Timestamp</code> to <code>str</code></a></li>
  </ul></li>
  <li><a href="#timezones" id="toc-timezones" class="nav-link" data-scroll-target="#timezones">Timezones</a>
  <ul class="collapse">
  <li><a href="#timezones-in-timestamps" id="toc-timezones-in-timestamps" class="nav-link" data-scroll-target="#timezones-in-timestamps">Timezones in timestamps</a></li>
  <li><a href="#no-timezone-given" id="toc-no-timezone-given" class="nav-link" data-scroll-target="#no-timezone-given">No timezone given</a></li>
  <li><a href="#timezones-as-capital-cities" id="toc-timezones-as-capital-cities" class="nav-link" data-scroll-target="#timezones-as-capital-cities">Timezones as capital cities</a></li>
  <li><a href="#timezones-in-pandas" id="toc-timezones-in-pandas" class="nav-link" data-scroll-target="#timezones-in-pandas">Timezones in pandas</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><img src="images/cover.png" class="img-fluid"></p>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>This blog post collects in one place a range of methods for converting datetime objects across types in python and pandas.</p>
<p>The code snippet and the subsequent diagram summarise the data casting between <code>datetime</code>, <code>int</code>, <code>str</code>, <code>pd.Timestamp</code>.</p>
<p>The remaining sections offer more details and examples about each of those methods. At the end of the post you will find a section about some snippets to manipulate <a href="https://geospatial.netlify.app/posts/gds-2024-01-24-timestamp/#timezones"><strong>timezones</strong></a> in all the examined formats.</p>
<div id="cell-3" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a datetime</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime(year<span class="op">=</span><span class="dv">2024</span>, month<span class="op">=</span><span class="dv">1</span>, day<span class="op">=</span><span class="dv">22</span>, hour<span class="op">=</span><span class="dv">13</span>, minute<span class="op">=</span><span class="dv">55</span>, second<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to string with specific format code</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>FORMAT_CODE <span class="op">=</span> <span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y, %H:%M:%S"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>dt_event_str <span class="op">=</span> dt_event.strftime(FORMAT_CODE)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># convert from string to datetime</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime.strptime(dt_event_str, FORMAT_CODE)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># convert from datetime to integer (milliseconds)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>msec_event <span class="op">=</span> <span class="bu">int</span>(dt_event.timestamp() <span class="op">*</span> <span class="dv">1000</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># convert from milliseconds to integer</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime.fromtimestamp(msec_event <span class="op">/</span> <span class="dv">1000</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># create a list of timestamps</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>dt_start, dt_end <span class="op">=</span> dt.datetime(<span class="dv">2022</span>, <span class="dv">3</span>, <span class="dv">1</span>), dt.datetime(<span class="dv">2022</span>, <span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>list_events <span class="op">=</span> []</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> dt_start <span class="op">&lt;=</span> dt_end:</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    list_events.append(dt_start)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    dt_start <span class="op">+=</span> dt.timedelta(days<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># convert list of timestamps to pandas DatetimeIdex of pd.Timestamps</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>index_events <span class="op">=</span> pd.to_datetime(list_events)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># convert pandas DatetimeIdex of pd.Timestamps to list of timestamps</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>list_events <span class="op">=</span> [dt.datetime.combine(x.date(), x.time()) <span class="cf">for</span> x <span class="kw">in</span> index_events]</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># convert pandas DatetimeIdex of pd.Timestamps to an Index of integers (nanoseconds)</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>index_events_int <span class="op">=</span> index_events.astype(<span class="bu">int</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># convert pandas Index of integers (nanoseconds) to DatetimeIdex of pd.Timestamps</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>index_events <span class="op">=</span> pd.to_datetime(index_events_int)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co"># convert pandas DatetimeIdex of pd.Timestamps to an Index of strings</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>index_events_str <span class="op">=</span> index_events.astype(<span class="bu">str</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co"># convert pandas Index of strings to DatetimeIdex of pd.Timestamps</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>index_events <span class="op">=</span> pd.to_datetime(index_events_str)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/main_diagram.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given a timestamp with no further information about its unit of measurement, you can quickly trial and error its conversion to a human readable format with</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pd.Timestamp(<span class="op">&lt;</span>POSIX number here<span class="op">&gt;</span>, unit<span class="op">=</span><span class="st">"us"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The most common POSIX formats are:</p>
<ul>
<li>float, with six digits after the comma, where <code>1.000000</code> represents one second after the first of January 1970.</li>
<li>Integer in microsecond, usually denoted with the greek letter <span class="math inline">\(\mu\)</span>, in pandas are converted with <code>unit="us"</code>.</li>
<li>Integer in milliseconds in pandas are converted with <code>unit="ms"</code>.</li>
</ul>
<p>If none of the <code>unit</code> you try (look under the pd.Timestamp documentation for the complete list), nothing provides satisfactorily results it may be worth trying converting the numbers with <code>pd.Timedelta</code>.</p>
</div>
</div>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>When first started working with time series, a recurrent task was for me to google up ways to convert datetimes across python and pandas data types. It took me some times to get to have a grasp about the possibilities and conversion methods, as well as how to set and change timezones without making mistakes.</p>
<p>This blog post is for you to get the same information I got browsing for a while around various stackoverflows and documentation pages, all in one place.</p>
<p>As it is for <a href="https://geospatial.netlify.app/posts/gds-2022-10-03-polygons-part-1/">manipulations of polygons</a>, handling datetimes is another recurring task in geospatial data science.</p>
<p>In python there are multiple ways to encode a point in time according to a range of criteria:</p>
<ul>
<li>Readability</li>
<li>Storing space</li>
<li>Out of the box methods</li>
</ul>
<p>Before delving into some examples, let’s warm up with a code snippet showing what can go wrong if dates and times are manipulated carelessly.</p>
<div id="cell-7" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>FORMAT <span class="op">=</span> <span class="st">"%H:%M:%S%z %Y-%m-</span><span class="sc">%d</span><span class="st">"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>event_1 <span class="op">=</span> dt.datetime.strptime(<span class="st">"22:15:00+00:00 2022-05-01"</span>, FORMAT)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>event_2 <span class="op">=</span> dt.datetime.strptime(<span class="st">"18:30:00+00:00 2022-06-01"</span>, FORMAT)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Events as type </span><span class="sc">{</span><span class="bu">type</span>(event_1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Event 1: </span><span class="sc">{</span>event_1<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Event 2: </span><span class="sc">{</span>event_2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> event_1 <span class="op">&lt;</span> event_2: </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Datetime </span><span class="sc">{</span>event_1<span class="sc">}</span><span class="ss"> comes before </span><span class="sc">{</span>event_2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>event_1 <span class="op">=</span> event_1.strftime(FORMAT)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>event_2 <span class="op">=</span> event_2.strftime(FORMAT)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Events as type </span><span class="sc">{</span><span class="bu">type</span>(event_1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Event 1: </span><span class="sc">{</span>event_1<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Event 2: </span><span class="sc">{</span>event_2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> event_1 <span class="op">&gt;</span> event_2: </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Datetime </span><span class="sc">{</span>event_1<span class="sc">}</span><span class="ss"> comes after </span><span class="sc">{</span>event_2<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Oh, Really?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Events as type &lt;class 'datetime.datetime'&gt;
Event 1: 2022-05-01 22:15:00+00:00
Event 2: 2022-06-01 18:30:00+00:00

Datetime 2022-05-01 22:15:00+00:00 comes before 2022-06-01 18:30:00+00:00

Events as type &lt;class 'str'&gt;
Event 1: 22:15:00+0000 2022-05-01
Event 2: 18:30:00+0000 2022-06-01

Datetime 22:15:00+0000 2022-05-01 comes after 18:30:00+0000 2022-06-01.
Oh, Really?</code></pre>
</div>
</div>
<p>Can you see what went wrong?</p>
<p>In this example we started from two datetimes (any representation of a date and a time) in <code>string</code> format. These were converted to instances of <code>datetime.datetime</code> from the <a href="https://docs.python.org/3/library/datetime.html">standard library <code>datetime</code></a>.</p>
<p>The first odd thing, that becomes evident when calling <code>type(dt.datetime.strptime("22:15:00+00:00 2022-05-01", FORMAT))</code> is that <code>datetime.datetime</code> is not a class. It is a <code>type</code>, like <code>int</code> and <code>str</code>, so it does not follow the camel case convention<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>Also that the type name and the library name are the same. So, in some modules you will find <code>from datetime import datetime</code> and in other simply <code>import datetime</code>, a confusion that I avoid usually aliasing the library <code>datetime</code> to <code>dt</code>, as done in the previous example.</p>
<p>From the diagram shown, we can see another source of possible confusions: in the python world the term <code>timestamp</code> refers to a datetime object converted to an integer — more details in the section later about how this is done. In the pandas world instead, the term <code>timestamp</code> is used as the class that encodes the pandas datetime object. So there is a change in the naming convention if you are using the python standards libraries, or if you are using pandas.</p>
<p>Starting from the center of the diagram, in each section of this post we will explore a conversion and the specifications of the given types, leaving <code>pandas.Timestamp</code> for last.</p>
</section>
<section id="datetime.datetime-to-str-and-back" class="level2">
<h2 class="anchored" data-anchor-id="datetime.datetime-to-str-and-back"><code>datetime.datetime</code> to <code>str</code> and back</h2>
<p>There are many formats to represent a datetime into a string. One of the standard is specified in <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO8601</a>.</p>
<div id="cell-10" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a datetime - you need at least year, month and day.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime(year<span class="op">=</span><span class="dv">2024</span>, month<span class="op">=</span><span class="dv">1</span>, day<span class="op">=</span><span class="dv">22</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>dt_event</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>datetime.datetime(2024, 1, 22, 0, 0)</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a datetime with hour, minutes and seconds</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime(year<span class="op">=</span><span class="dv">2024</span>, month<span class="op">=</span><span class="dv">1</span>, day<span class="op">=</span><span class="dv">22</span>, hour<span class="op">=</span><span class="dv">13</span>, minute<span class="op">=</span><span class="dv">55</span>, second<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>dt_event</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>datetime.datetime(2024, 1, 22, 13, 55, 12)</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to string with a range of formats</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dt_event.strftime(<span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y, %H:%M:%S"</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dt_event.strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">, %H:%M"</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dt_event.strftime(<span class="st">"%H:%M"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>01/22/2024, 13:55:12
2024-01-22, 13:55
13:55</code></pre>
</div>
</div>
<p>Once we have the string we can move back to the timestamp object, passing the same format code (this operation is not bijective if some of the information is not included in the chosen format code).</p>
<p>More info about the format codes and what each letter means is available at the official documentation <a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior" class="uri">https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior</a>.</p>
<div id="cell-14" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a datetime object</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime(year<span class="op">=</span><span class="dv">2024</span>, month<span class="op">=</span><span class="dv">1</span>, day<span class="op">=</span><span class="dv">22</span>, hour<span class="op">=</span><span class="dv">13</span>, minute<span class="op">=</span><span class="dv">55</span>, second<span class="op">=</span><span class="dv">12</span>, microsecond<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Datetime: </span><span class="sc">{</span>dt_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to string</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>FORMAT_CODE <span class="op">=</span> <span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y, %H:%M:%S"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>str_event <span class="op">=</span> dt_event.strftime(FORMAT_CODE)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"String:   </span><span class="sc">{</span>dt_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># string to datetime</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Datetime: </span><span class="sc">{</span>dt<span class="sc">.</span>datetime<span class="sc">.</span>strptime(str_event, FORMAT_CODE)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Datetime: 2024-01-22 13:55:12.000120
String:   2024-01-22 13:55:12.000120
Datetime: 2024-01-22 13:55:12</code></pre>
</div>
</div>
<p>In addition to <code>timestamp.timestamp</code> you can create only the <code>time</code>, the <code>date</code> and a <code>timedelta</code>.</p>
<div id="cell-16" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dt.time(hour<span class="op">=</span><span class="dv">4</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dt.date(year<span class="op">=</span><span class="dv">2024</span>, month<span class="op">=</span><span class="dv">3</span>, day<span class="op">=</span><span class="dv">11</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dt.timedelta(hours<span class="op">=</span><span class="dv">3</span>))  </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># we can not sum a timedelta to a time</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dt.time(hour<span class="op">=</span><span class="dv">4</span>) <span class="op">+</span> dt.time(hour<span class="op">=</span><span class="dv">4</span>))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">TypeError</span> <span class="im">as</span> err:</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error raised: TypeError </span><span class="sc">{</span>err<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># nor to a date</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dt.date(year<span class="op">=</span><span class="dv">2024</span>, month<span class="op">=</span><span class="dv">3</span>, day<span class="op">=</span><span class="dv">11</span>) <span class="op">+</span> dt.time(hour<span class="op">=</span><span class="dv">4</span>))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">TypeError</span> <span class="im">as</span> err:</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error raised: TypeError </span><span class="sc">{</span>err<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># but we can sum it to a timestamp</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dt.datetime(year<span class="op">=</span><span class="dv">2024</span>, month<span class="op">=</span><span class="dv">3</span>, day<span class="op">=</span><span class="dv">11</span>, hour<span class="op">=</span><span class="dv">3</span>) <span class="op">+</span> dt.timedelta(hours<span class="op">=</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>04:00:00
2024-03-11
3:00:00
Error raised: TypeError unsupported operand type(s) for +: 'datetime.time' and 'datetime.time'
Error raised: TypeError unsupported operand type(s) for +: 'datetime.date' and 'datetime.time'
2024-03-11 07:00:00</code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if we quickly want to have the timestamp converted to a string in isoformat we can use:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dt_event.isoformat()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>'2024-01-22T13:55:12.000120'</code></pre>
</div>
</div>
</section>
<section id="datetime.datetime-to-int-and-back" class="level2">
<h2 class="anchored" data-anchor-id="datetime.datetime-to-int-and-back"><code>datetime.datetime</code> to <code>int</code> and back</h2>
<p>The integer representation of a <code>datetime</code> is called <code>timestamp</code> in the python world. We note again that it is not the same as the the pandas <code>Timestamp</code> object.</p>
<p>A timestamp is a numerical representation of a date in the <strong>Unix epoch</strong> (or <strong>Unix time</strong> or <strong>POSIX time</strong> or <strong>Unix timestamp</strong>). It is the number of seconds that have elapsed since January 1, 1970 (midnight UTC/GMT), not counting leap seconds (using the ISO 8601 convention it is <em>1970-01-01T00:00:00Z</em>).</p>
<div id="cell-19" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime(year<span class="op">=</span><span class="dv">2024</span>, month<span class="op">=</span><span class="dv">3</span>, day<span class="op">=</span><span class="dv">11</span>, hour<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>dt_event.timestamp?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Docstring: Return POSIX timestamp as float.
Type:      builtin_function_or_method</code></pre>
</div>
</div>
<p>Out of the box, the python timestamp is in seconds, and encoded as a <code>float</code>. In some dataset, and to save memory, it can be encoded in milliseconds or even in microseconds, and encoded as an integer.</p>
<div id="cell-21" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Datetime:         </span><span class="sc">{</span>dt_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Python timestamp: </span><span class="sc">{</span>dt_event<span class="sc">.</span>timestamp()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Datetime:         2024-03-11 03:00:00
Python timestamp: 1710126000.0</code></pre>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ISO_FORMAT_CODE <span class="op">=</span> <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">T%H:%M:%S%z"</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>dt_event_zero <span class="op">=</span> dt.datetime.strptime(<span class="st">"1970-01-01T00:00:00Z"</span>, ISO_FORMAT_CODE)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Datetime:         </span><span class="sc">{</span>dt_event_zero<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Python timestamp: </span><span class="sc">{</span>dt_event_zero<span class="sc">.</span>timestamp()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Datetime:         1970-01-01 00:00:00+00:00
Python timestamp: 0.0</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime(year<span class="op">=</span><span class="dv">2024</span>, month<span class="op">=</span><span class="dv">3</span>, day<span class="op">=</span><span class="dv">11</span>, hour<span class="op">=</span><span class="dv">3</span>, minute<span class="op">=</span><span class="dv">13</span>, second<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>sec_event <span class="op">=</span> <span class="bu">int</span>(dt_event.timestamp())</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>msec_event <span class="op">=</span> <span class="bu">int</span>(dt_event.timestamp() <span class="op">*</span> <span class="dv">1000</span>)  <span class="co"># convert to milliseconds before casting</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>back_to_dt_event <span class="op">=</span> dt.datetime.fromtimestamp(msec_event <span class="op">/</span> <span class="dv">1000</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Datetime:              </span><span class="sc">{</span>dt_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Python timestamp (s):  </span><span class="sc">{</span>sec_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Python timestamp (ms): </span><span class="sc">{</span>msec_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Back to datetime:      </span><span class="sc">{</span>back_to_dt_event<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Datetime:              2024-03-11 03:13:45
Python timestamp (s):  1710126825
Python timestamp (ms): 1710126825000
Back to datetime:      2024-03-11 03:13:45</code></pre>
</div>
</div>
</section>
<section id="datetime.datetime-str-and-int-to-pandas.timestamp-and-back" class="level2">
<h2 class="anchored" data-anchor-id="datetime.datetime-str-and-int-to-pandas.timestamp-and-back"><code>datetime.datetime</code>, <code>str</code> and <code>int</code> to <code>pandas.Timestamp</code> and back</h2>
<p>In pandas we typically don’t deal with a single datetime, but with a list of those. With timeseries, pandas becomes particularly efficient when timeseries are used as data frames indexes.</p>
<p>Here we see some examples of conversion of lists of <code>datetime.datetime</code> into pandas <code>pd.Timestamp</code> indexes, and into <code>int</code> and <code>string</code>.</p>
<div id="cell-25" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_events(iterable_events):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""helper to print info about iterable events len and types"""</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="bu">len</span>(iterable_events)<span class="sc">}</span><span class="ss"> days: "</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"["</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ev <span class="kw">in</span> iterable_events:</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"    </span><span class="sc">{</span>ev<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"]"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"This is a </span><span class="sc">{</span><span class="bu">type</span>(iterable_events)<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span><span class="bu">type</span>(iterable_events[<span class="dv">0</span>])<span class="sc">}</span><span class="ss"> elements."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-26" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of datetime.datetime</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>dt_start <span class="op">=</span> dt.datetime(<span class="dv">2022</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>dt_end <span class="op">=</span> dt.datetime(<span class="dv">2022</span>, <span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>list_events <span class="op">=</span> []</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> dt_start <span class="op">&lt;=</span> dt_end:</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    list_events.append(dt_start)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    dt_start <span class="op">+=</span> dt.timedelta(days<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>print_events(list_events)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10 days: 
[
    2022-03-01 00:00:00
    2022-03-02 00:00:00
    2022-03-03 00:00:00
    2022-03-04 00:00:00
    2022-03-05 00:00:00
    2022-03-06 00:00:00
    2022-03-07 00:00:00
    2022-03-08 00:00:00
    2022-03-09 00:00:00
    2022-03-10 00:00:00
]
This is a &lt;class 'list'&gt; of &lt;class 'datetime.datetime'&gt; elements.</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the same list as above, with pandas.date_range https://pandas.pydata.org/docs/reference/api/pandas.date_range.html</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>dt_start <span class="op">=</span> dt.datetime(<span class="dv">2022</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>dt_end <span class="op">=</span> dt.datetime(<span class="dv">2022</span>, <span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>index_events <span class="op">=</span> pd.date_range(start<span class="op">=</span>dt_start, end<span class="op">=</span>dt_end)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>print_events(index_events)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10 days: 
[
    2022-03-01 00:00:00
    2022-03-02 00:00:00
    2022-03-03 00:00:00
    2022-03-04 00:00:00
    2022-03-05 00:00:00
    2022-03-06 00:00:00
    2022-03-07 00:00:00
    2022-03-08 00:00:00
    2022-03-09 00:00:00
    2022-03-10 00:00:00
]
This is a &lt;class 'pandas.core.indexes.datetimes.DatetimeIndex'&gt; of &lt;class 'pandas._libs.tslibs.timestamps.Timestamp'&gt; elements.</code></pre>
</div>
</div>
<div id="cell-28" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the index to a dataframe</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.random.choice(<span class="bu">list</span>(<span class="st">"random"</span>), size<span class="op">=</span><span class="bu">len</span>(index_events))).set_index(index_events)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-03-01</td>
<td>m</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-03-02</td>
<td>r</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-03-03</td>
<td>n</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-03-04</td>
<td>o</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-03-05</td>
<td>r</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-03-06</td>
<td>d</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-03-07</td>
<td>m</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-03-08</td>
<td>n</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-03-09</td>
<td>a</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-03-10</td>
<td>d</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same pandas index_events created above can be created directly with strings</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>index_events <span class="op">=</span> pd.date_range(start<span class="op">=</span><span class="st">'3/1/2022'</span>, end<span class="op">=</span><span class="st">'3/10/2022'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>print_events(index_events)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10 days: 
[
    2022-03-01 00:00:00
    2022-03-02 00:00:00
    2022-03-03 00:00:00
    2022-03-04 00:00:00
    2022-03-05 00:00:00
    2022-03-06 00:00:00
    2022-03-07 00:00:00
    2022-03-08 00:00:00
    2022-03-09 00:00:00
    2022-03-10 00:00:00
]
This is a &lt;class 'pandas.core.indexes.datetimes.DatetimeIndex'&gt; of &lt;class 'pandas._libs.tslibs.timestamps.Timestamp'&gt; elements.</code></pre>
</div>
</div>
<div id="cell-30" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list of datetimes to the pandas index</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>index_events_converted <span class="op">=</span> pd.to_datetime(list_events)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>print_events(index_events)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> pd.testing.assert_index_equal(index_events_converted, index_events):</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The two index events are not considered equal! Why?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10 days: 
[
    2022-03-01 00:00:00
    2022-03-02 00:00:00
    2022-03-03 00:00:00
    2022-03-04 00:00:00
    2022-03-05 00:00:00
    2022-03-06 00:00:00
    2022-03-07 00:00:00
    2022-03-08 00:00:00
    2022-03-09 00:00:00
    2022-03-10 00:00:00
]
This is a &lt;class 'pandas.core.indexes.datetimes.DatetimeIndex'&gt; of &lt;class 'pandas._libs.tslibs.timestamps.Timestamp'&gt; elements.

The two index events are not considered equal! Why?</code></pre>
</div>
</div>
<p>Here something interesting have happened. Even if the two series have the same values, they are not equal.</p>
<p>Printing them individually will show why:</p>
<div id="cell-32" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>index_events</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>DatetimeIndex(['2022-03-01', '2022-03-02', '2022-03-03', '2022-03-04',
               '2022-03-05', '2022-03-06', '2022-03-07', '2022-03-08',
               '2022-03-09', '2022-03-10'],
              dtype='datetime64[ns]', freq='D')</code></pre>
</div>
</div>
<div id="cell-33" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>index_events_converted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>DatetimeIndex(['2022-03-01', '2022-03-02', '2022-03-03', '2022-03-04',
               '2022-03-05', '2022-03-06', '2022-03-07', '2022-03-08',
               '2022-03-09', '2022-03-10'],
              dtype='datetime64[ns]', freq=None)</code></pre>
</div>
</div>
<p>The <code>freq=</code> value of the converted frequency is different from the frequency of the original one, that is defined by days. Under the hood they are different objects, as the first one contains first and last element and the frequency, and the second contains every single individual element.</p>
<p>Even assigning the frequency to <code>index_events_converted</code> afterwards does not make the two DateteimeIndex equal:</p>
<div id="cell-35" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>index_events_converted.freq <span class="op">=</span> <span class="st">"D"</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>index_events_converted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>DatetimeIndex(['2022-03-01', '2022-03-02', '2022-03-03', '2022-03-04',
               '2022-03-05', '2022-03-06', '2022-03-07', '2022-03-08',
               '2022-03-09', '2022-03-10'],
              dtype='datetime64[ns]', freq='D')</code></pre>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> pd.testing.assert_index_equal(index_events_converted, index_events):</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"The two index events are still not equal!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The two index events are still not equal!</code></pre>
</div>
</div>
<p>When working with <code>pd.Timestamp</code> we have to keep in mind that different constructors creating the same numerical results produce different objects.</p>
<p>What about the memory? Also this is the same for both objects:</p>
<div id="cell-38" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(index_events.memory_usage())</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(index_events_converted.memory_usage())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>80
80</code></pre>
</div>
</div>
<p>Now we can convert back from a pandas <code>DatetimeIndex</code> to a list of <code>datetime.datetime</code> objects.</p>
<p>A <code>pd.Timestamp</code> object can not be converted directly into a <code>datetime.datetime</code> object, but it can be converted into a <code>datetime.date</code> and a <code>datetime.time</code> object.</p>
<p>So we can use a list comprehension and combine the two exported formats:</p>
<div id="cell-40" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Pandas Timestamp object</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>pd_event <span class="op">=</span> pd.Timestamp(<span class="st">'2022-06-18 12:34:56'</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the Timestamp to a Python datetime.date object</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>date <span class="op">=</span> pd_event.date()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>time <span class="op">=</span> pd_event.time()</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime.combine(date, time)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Event </span><span class="sc">{</span>pd_event<span class="sc">}</span><span class="ss"> of type </span><span class="sc">{</span><span class="bu">type</span>(pd_event)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Event </span><span class="sc">{</span>dt_event<span class="sc">}</span><span class="ss"> of type </span><span class="sc">{</span><span class="bu">type</span>(dt_event)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Event 2022-06-18 12:34:56 of type &lt;class 'pandas._libs.tslibs.timestamps.Timestamp'&gt;
Event 2022-06-18 12:34:56 of type &lt;class 'datetime.datetime'&gt;</code></pre>
</div>
</div>
<div id="cell-41" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>index_event_converted_back <span class="op">=</span> [dt.datetime.combine(x.date(), x.time()) <span class="cf">for</span> x <span class="kw">in</span> index_events_converted]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>print_events(index_event_converted_back)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10 days: 
[
    2022-03-01 00:00:00
    2022-03-02 00:00:00
    2022-03-03 00:00:00
    2022-03-04 00:00:00
    2022-03-05 00:00:00
    2022-03-06 00:00:00
    2022-03-07 00:00:00
    2022-03-08 00:00:00
    2022-03-09 00:00:00
    2022-03-10 00:00:00
]
This is a &lt;class 'list'&gt; of &lt;class 'datetime.datetime'&gt; elements.</code></pre>
</div>
</div>
<section id="pandas-timestamp-to-int" class="level3">
<h3 class="anchored" data-anchor-id="pandas-timestamp-to-int">Pandas <code>Timestamp</code> to <code>int</code></h3>
<p>To convert a pandas <code>DatetimeIndex</code> from <code>pd.Timestamp</code> to integer, we have to use the <code>.astype</code> method of a pandas series.</p>
<div id="cell-43" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(index_events)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>index_events_int <span class="op">=</span> index_events.astype(<span class="bu">int</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(index_events_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DatetimeIndex(['2022-03-01', '2022-03-02', '2022-03-03', '2022-03-04',
               '2022-03-05', '2022-03-06', '2022-03-07', '2022-03-08',
               '2022-03-09', '2022-03-10'],
              dtype='datetime64[ns]', freq='D')

Index([1646092800000000000, 1646179200000000000, 1646265600000000000,
       1646352000000000000, 1646438400000000000, 1646524800000000000,
       1646611200000000000, 1646697600000000000, 1646784000000000000,
       1646870400000000000],
      dtype='int64')</code></pre>
</div>
</div>
<p>The timestamps are now in nanoseconds, as specified in the dtype of the DatetimeIndex <code>index_events</code>. You have to divide it by 1e9 to have them in seconds:</p>
<div id="cell-45" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>index_events_int_sec <span class="op">=</span> (index_events_int <span class="op">/</span> <span class="fl">1e9</span>).astype(<span class="bu">int</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>index_events_int_sec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>Index([1646092800, 1646179200, 1646265600, 1646352000, 1646438400, 1646524800,
       1646611200, 1646697600, 1646784000, 1646870400],
      dtype='int64')</code></pre>
</div>
</div>
<div id="cell-46" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert back to `DatetimeIndex`</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>pd.to_datetime(index_events_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>DatetimeIndex(['2022-03-01', '2022-03-02', '2022-03-03', '2022-03-04',
               '2022-03-05', '2022-03-06', '2022-03-07', '2022-03-08',
               '2022-03-09', '2022-03-10'],
              dtype='datetime64[ns]', freq=None)</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert back to `DatetimeIndex`. Pandas expects nanoseconds</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>pd.to_datetime(index_events_int_sec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>DatetimeIndex(['1970-01-01 00:00:01.646092800',
               '1970-01-01 00:00:01.646179200',
               '1970-01-01 00:00:01.646265600',
                  '1970-01-01 00:00:01.646352',
               '1970-01-01 00:00:01.646438400',
               '1970-01-01 00:00:01.646524800',
               '1970-01-01 00:00:01.646611200',
               '1970-01-01 00:00:01.646697600',
                  '1970-01-01 00:00:01.646784',
               '1970-01-01 00:00:01.646870400'],
              dtype='datetime64[ns]', freq=None)</code></pre>
</div>
</div>
</section>
<section id="pandas-timestamp-to-str" class="level3">
<h3 class="anchored" data-anchor-id="pandas-timestamp-to-str">Pandas <code>Timestamp</code> to <code>str</code></h3>
<p>Conversion to strings works in the same way as with <code>int</code>.</p>
<div id="cell-49" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert from DatetimeIndex to string.</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(index_events)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>index_events_str <span class="op">=</span> index_events.astype(<span class="bu">str</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(index_events_str)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DatetimeIndex(['2022-03-01', '2022-03-02', '2022-03-03', '2022-03-04',
               '2022-03-05', '2022-03-06', '2022-03-07', '2022-03-08',
               '2022-03-09', '2022-03-10'],
              dtype='datetime64[ns]', freq='D')

Index(['2022-03-01', '2022-03-02', '2022-03-03', '2022-03-04', '2022-03-05',
       '2022-03-06', '2022-03-07', '2022-03-08', '2022-03-09', '2022-03-10'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-50" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert back from string to DatetimeIndex</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>pd.to_datetime(index_events_str)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>DatetimeIndex(['2022-03-01', '2022-03-02', '2022-03-03', '2022-03-04',
               '2022-03-05', '2022-03-06', '2022-03-07', '2022-03-08',
               '2022-03-09', '2022-03-10'],
              dtype='datetime64[ns]', freq=None)</code></pre>
</div>
</div>
</section>
</section>
<section id="timezones" class="level2">
<h2 class="anchored" data-anchor-id="timezones">Timezones</h2>
<p>Some basic concepts first:</p>
<ul>
<li><strong>UTC</strong> universal time coordinates: is the standard to assign to each country in the world a timezone, that is an offset in respect to the timezone zero, also called Zulu or GTM.</li>
<li><strong>GMT</strong> Greenwich Mean Time: is the time zone at the meridian zero, passing at Greenwich in England. The UTC standard tells you how many time zone you are away from Greenwich.</li>
<li><strong>Zulu</strong> for the NATO alphabet letter <code>Z</code>, was originally indicating the letter z as in “zero meridian”. This is an equivalent of GTM and it is commonly used in the army and in the civilian aviation. The final “zulu” in a radio message refers to the fact that the time is not read in local time. For example <code>02:00am</code> at GMT, would read “zero two hundred zulu” in a radio communication.</li>
</ul>
<p>The names of the timezones are typically the UTC offsets, written as suffix to the timestamps, such as <code>+02:00</code> or <code>-05:00</code>, though some particularly recurring timezones have their names, such as:</p>
<ul>
<li>Eastern Standard Time (EST): UTC-0500 or 5 hours behind GMT.</li>
<li>Central Standard Time (CST): UTC-0600 or 6 hours behind GMT.</li>
<li>Mountain Standard Time (MST): UTC-0700 or 7 hours behind GMT.</li>
<li>Pacific Standard Time (PST): UTC-0800 or 8 hours behind GMT.</li>
</ul>
<section id="timezones-in-timestamps" class="level3">
<h3 class="anchored" data-anchor-id="timezones-in-timestamps">Timezones in timestamps</h3>
<p>When timezones are written as offsets and appended to the timestamps, the are <strong>also summed or subtracted</strong> to the datetime itself.</p>
<p>For example to write <code>2023-02-21T06:07:21+03:30</code> in GMT, we have to set the offset to zero and subtract the offset: <code>2023-02-21T02:37:21+00:00</code>, that in the ISO 8601 becomes <code>2023-02-21T02:37:21Z</code>, with in the Zulu timezone, and in a convention that is often found in public datasets as <code>2023-02-21 02:37:21 UTC</code>, conflating the concepts of <code>GMT</code> and <code>UTC</code>.</p>
<p>Another way of encoding the timezones is with the name of a representative city where the timezone belongs to. <code>+03:30</code> does not tell much about where we are, if compared to <code>"Asia/Tehran"</code>.</p>
</section>
<section id="no-timezone-given" class="level3">
<h3 class="anchored" data-anchor-id="no-timezone-given">No timezone given</h3>
<p>When a timezone is not specified, the timestamp is said to be <strong>naive</strong>, or not timezone-aware.</p>
<p>In this case it is important to check with the data provider if the datetime are given in local time or at GMT. If the datetime are given as integer UNIX timestamps, then they are at GMT, unless there was a mistake in the data ingestion.</p>
<div id="cell-52" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dateutil <span class="im">import</span> tz</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># naive</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>str_event <span class="op">=</span> <span class="st">"2023-02-21 02:37:21"</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime.strptime(str_event, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"naive datetime:  </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co"># GTM</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>str_event <span class="op">=</span> <span class="st">"2023-02-21 02:37:21 GMT"</span>  <span class="co"># works also with UTC instead of GMT</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime.strptime(str_event, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S %Z"</span>)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"GTM datetime:    </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co"># zero offset</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>str_event <span class="op">=</span> <span class="st">"2023-02-21 02:37:21+00:00"</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime.strptime(str_event, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S%z"</span>)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"datetime +00:00: </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="co"># +1h offset</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>str_event <span class="op">=</span> <span class="st">"2023-02-21 03:37:21+01:00"</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime.strptime(str_event, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S%z"</span>)</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"datetime +01:00: </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>naive datetime:  2023-02-21T02:37:21
GTM datetime:    2023-02-21T02:37:21
datetime +00:00: 2023-02-21T02:37:21+00:00
datetime +01:00: 2023-02-21T03:37:21+01:00</code></pre>
</div>
</div>
<p>The code above should be enough to convince you that when the offset is not specified, then we can assume the datetime is at GMT, as it was at GMT when we passed as a string.</p>
</section>
<section id="timezones-as-capital-cities" class="level3">
<h3 class="anchored" data-anchor-id="timezones-as-capital-cities">Timezones as capital cities</h3>
<p>Below, with <code>dateutil</code> we can also pass the offset with the capital city based offset, such as “Asia/Tehran”.</p>
<div id="cell-54" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># country/city offset</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>str_event <span class="op">=</span> <span class="st">"2023-02-21 03:37:21"</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>str_offset <span class="op">=</span> <span class="st">"Asia/Tehran"</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime.strptime(str_event, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"datetime: </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt_event.astimezone(tz.gettz(str_offset))</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"datetime: </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>datetime: 2023-02-21T03:37:21
datetime: 2023-02-21T07:07:21+03:30</code></pre>
</div>
</div>
<p>If you use this solution be aware that there is no validation, and if the string is misspelled or non existing, the datetime will be assigned the default <code>+00:00</code> offset.</p>
<div id="cell-56" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime.strptime(str_event, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"datetime: </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>correct <span class="op">=</span> <span class="st">"Asia/Tehran"</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt_event.astimezone(tz.gettz(correct))</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"datetime in </span><span class="sc">{</span>correct<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>misspelled <span class="op">=</span> <span class="st">"Asia/Theran"</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt_event.astimezone(tz.gettz(misspelled))</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"datetime in </span><span class="sc">{</span>misspelled<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>plain_wrong <span class="op">=</span> <span class="st">"MiddleEarth/County"</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt_event.astimezone(tz.gettz(plain_wrong))</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"datetime in </span><span class="sc">{</span>plain_wrong<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>datetime: 2023-02-21T03:37:21
datetime in Asia/Tehran: 2023-02-21T07:07:21+03:30
datetime in Asia/Theran: 2023-02-21T03:37:21+00:00
datetime in MiddleEarth/County: 2023-02-21T03:37:21+00:00</code></pre>
</div>
</div>
<p>Not raising an error for non existing capitals is not ideal. So rather than assigning the timezone <code>dateutil</code> I would recommend the method <code>timezone</code> from <code>pytz</code>.</p>
<div id="cell-58" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pytz <span class="im">import</span> timezone</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt.datetime.strptime(str_event, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S"</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>correct <span class="op">=</span> <span class="st">"Asia/Tehran"</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>dt_event <span class="op">=</span> dt_event.astimezone(tz.gettz(correct))</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"datetime in </span><span class="sc">{</span>correct<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>plain_wrong <span class="op">=</span> <span class="st">"MiddleEarth/County"</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    dt_event.astimezone(timezone(plain_wrong))</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"datetime in </span><span class="sc">{</span>plain_wrong<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>dt_event<span class="sc">.</span>isoformat()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> err:</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error raised: </span><span class="sc">{</span><span class="bu">type</span>(err)<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>err<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>datetime in Asia/Tehran: 2023-02-21T07:07:21+03:30
Error raised: &lt;class 'pytz.exceptions.UnknownTimeZoneError'&gt; 'MiddleEarth/County'</code></pre>
</div>
</div>
</section>
<section id="timezones-in-pandas" class="level3">
<h3 class="anchored" data-anchor-id="timezones-in-pandas">Timezones in pandas</h3>
<p>Also to the <code>pd.Timestamp</code> object can be assigned a timezone with <code>tz_localize</code> and can be converted from one timezone to another with <code>tz_convert</code> (this last works only with the non-naive timestamps).</p>
<div id="cell-60" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>index_events <span class="op">=</span> pd.date_range(start<span class="op">=</span><span class="st">'3/1/2022'</span>, end<span class="op">=</span><span class="st">'3/10/2022'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-61" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    index_events.tz_convert(<span class="st">'US/Pacific'</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">TypeError</span> <span class="im">as</span> err:</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"We can not use tz_convert directly. Error raised: </span><span class="sc">{</span>err<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We can not use tz_convert directly. Error raised: Cannot convert tz-naive timestamps, use tz_localize to localize</code></pre>
</div>
</div>
<div id="cell-62" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>index_events_localised <span class="op">=</span> index_events.tz_localize(<span class="st">'US/Pacific'</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>print_events(index_events_localised)  <span class="co"># note that the datetimes are not shifted! They are considered in local time at the specified location</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10 days: 
[
    2022-03-01 00:00:00-08:00
    2022-03-02 00:00:00-08:00
    2022-03-03 00:00:00-08:00
    2022-03-04 00:00:00-08:00
    2022-03-05 00:00:00-08:00
    2022-03-06 00:00:00-08:00
    2022-03-07 00:00:00-08:00
    2022-03-08 00:00:00-08:00
    2022-03-09 00:00:00-08:00
    2022-03-10 00:00:00-08:00
]
This is a &lt;class 'pandas.core.indexes.datetimes.DatetimeIndex'&gt; of &lt;class 'pandas._libs.tslibs.timestamps.Timestamp'&gt; elements.</code></pre>
</div>
</div>
<div id="cell-63" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>print_events(index_events_localised.tz_convert(<span class="st">'GMT'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10 days: 
[
    2022-03-01 08:00:00+00:00
    2022-03-02 08:00:00+00:00
    2022-03-03 08:00:00+00:00
    2022-03-04 08:00:00+00:00
    2022-03-05 08:00:00+00:00
    2022-03-06 08:00:00+00:00
    2022-03-07 08:00:00+00:00
    2022-03-08 08:00:00+00:00
    2022-03-09 08:00:00+00:00
    2022-03-10 08:00:00+00:00
]
This is a &lt;class 'pandas.core.indexes.datetimes.DatetimeIndex'&gt; of &lt;class 'pandas._libs.tslibs.timestamps.Timestamp'&gt; elements.</code></pre>
</div>
</div>
<p>For a given dataset of datetime in GMT, we have first to localise them over Greenwich, and then convert to the local timezone.</p>
<div id="cell-65" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>index_events <span class="op">=</span> pd.date_range(start<span class="op">=</span><span class="st">'3/1/2022'</span>, end<span class="op">=</span><span class="st">'3/10/2022'</span>).tz_localize(<span class="st">"GMT"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>print_events(index_events.tz_convert(<span class="st">'US/Pacific'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10 days: 
[
    2022-02-28 16:00:00-08:00
    2022-03-01 16:00:00-08:00
    2022-03-02 16:00:00-08:00
    2022-03-03 16:00:00-08:00
    2022-03-04 16:00:00-08:00
    2022-03-05 16:00:00-08:00
    2022-03-06 16:00:00-08:00
    2022-03-07 16:00:00-08:00
    2022-03-08 16:00:00-08:00
    2022-03-09 16:00:00-08:00
]
This is a &lt;class 'pandas.core.indexes.datetimes.DatetimeIndex'&gt; of &lt;class 'pandas._libs.tslibs.timestamps.Timestamp'&gt; elements.</code></pre>
</div>
</div>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>In Python &gt;3 the concepts of class and type was unified, and pure <code>type</code> objects are now only the native ones.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sebastianof\.github\.io\/GeoDsBlog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Blog made with <a href="https://quarto.org/">Quarto</a>, by Sebastiano Ferraris. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sebastianof/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:sebastiano.ferraris@gmail.com">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>